{{- /*
  Shortcode: text_snippet.html
  Purpose: Renders centered text content provided within the shortcode. Best used for short text blocks like introductions or as a text separator between sections.

  Target: Global

  Example:
  {{< text_snippet TITLE="" >}}
  /... Markdown .../
  {{< /text_snippet >}}

  Params:
  - TITLE (string, optional): H2 heading.

  Error handler:
  - ocdWarn (global)
  - OCD (scoped)

  Docs: https://alpha.oxypteros.com/shortcodes/text-snippet
  Repo: https://github.com/oxypteros/alpha
*/}}
{{- /* Shortcode rules */}}
{{- $rules := index .Site.Data.shortcodes.rules .Name -}}

{{- /* Vars */}}
{{- $ocdWarnEnabled := .Site.Params.ocdWarn_enabled | default true -}}
{{- $ocdEnabled := and hugo.IsDevelopment (.Site.Params.ocd_enabled | default true) -}}
{{- $validInput := "" -}}
{{- $validationResult := "" -}}

{{- /* Get shortcodes rules and validate input */}}
{{- if $rules -}}
  {{- $rules = merge $rules (dict "scName" .Name) -}}
  {{- $validationResult = partial "ocd/core/shortcodes/validator.logic.html" (dict "rules" $rules "userInput" .Params) -}}
  {{- $validInput = $validationResult.isValid }}
{{- else -}}
  {{- warnf "OCD: No rules found in 'data/shortcodes/rules.toml' for shortcode '%s'. Validation will be skipped." .Name -}}
{{- end -}}

{{- /* On failed input validation call the OCD handler */}}
{{- if not $validInput -}}
  {{- if or ($ocdWarnEnabled) ($ocdEnabled) -}}
    {{- partial "ocd/core/shortcodes/handler.logic.html" (dict "errors" $validationResult.errors "rules" $rules "page" .Page "position" .Position) -}}
  {{- end -}}
{{- end -}}

{{- /* * On successful validations render the shortcode */}}
{{- if $validInput }}
  {{- $data := $validationResult.data -}}
  {{- $content := .Inner | markdownify }}
  {{- /* Shortcode Rendering */}}
  <div class="mt-8 mb-32 flex w-full max-w-7xl flex-col items-center px-4">
    {{- with $data.title }}
      <h2
        class="font-200 text-on-sur-var dark:text-on-sur-var-d mb-16 w-full text-center text-4xl leading-normal wrap-break-word hyphens-manual"
      >
        {{- . -}}
      </h2>
    {{- end }}
    <div class="font-300 max-w-story text-center text-xl leading-relaxed">
      {{ $content }}
    </div>
  </div>
{{- end -}}

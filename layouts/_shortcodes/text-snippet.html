{{- /*
  Shortcode: text-snippet.html
  Purpose: Renders centered text content provided within the shortcode. Best used for short text blocks like introductions or as a text separator between sections.

  Target: Global

  Example:
  { {< text-snippet TITLE="" >} }
  /... Markdown .../
  { {< /text-snippet >} }

  Params:
  - TITLE (string, optional): H2 heading.

  Error handler:
  - ocdWarn (global)
  - OCD (scoped)

  Docs: https://alpha.oxypteros.com/shortcodes/text-snippet
  Repo: https://github.com/oxypteros/alpha
*/}}
{{- $ocdWarnEnabled := .Site.Params.ocdWarn_enabled | default true -}}
{{- $ocdEnabled := and hugo.IsDevelopment (.Site.Params.ocd_enabled | default true) -}}

{{- /* * Text-snippet Shortcode Data */}}
{{- $scName := "text-snippet" -}}
{{- /* ** Text-snippet shortcode rules */}}
{{- $rules := dict
  "validKeys" (slice "TITLE")
  "params" (dict
  "TITLE"  (dict "validation" "any_string")
  )
-}}
{{- /* ** Text-snippet shortcode metadata */}}
{{- $errorMeta := dict
  "docURL" "https://alpha.oxypteros.com/docs/shortcodes/text-snippet"
  "example" "<br>&lbrace;&lbrace;&lt; text-snippet TITLE=\"Example title\" &gt;&rbrace;&rbrace;<br><br>/... Markdown .../<br><br>&lbrace;&lbrace;&lt; /text-snippet &gt;&rbrace;&rbrace;"
  "errorCodes" (dict
  "invalidKey"   "ocd-sc-130"
  )
-}}

{{- /* * Validate shortcode input */}}
{{- $validationResult := partial "ocd/core/validator.logic.html" (dict "rules" $rules "userInput" .Params) -}}

{{- /* ** Conditions to render shortcode or OCD */}}
{{- /* *** Input validation */}}
{{- $validInput := $validationResult.isValid -}}

{{- /* - On failed input validation call the OCD handler */}}
{{- if not $validInput }}
  {{ if or ($ocdWarnEnabled) ($ocdEnabled) }}
    {{- partial "ocd/core/handler.logic.html" (dict
      "scName"   .Name
      "errors"   $validationResult.errors
      "rules"    $rules
      "meta"     $errorMeta
      "page"     .Page
      "position" .Position
      )
    -}}
  {{- end }}
{{- end }}

{{- /* * On successful validations render shortcode */}}
{{- if $validInput }}
  {{- $data := $validationResult.data -}}
  {{- $content := .Inner | markdownify }}
  {{- /* Shortcode Rendering */}}
  <div class="mt-8 mb-32 flex w-full max-w-7xl flex-col items-center px-4">
    {{- with $data.title }}
      <h2
        class="font-200 text-on-sur-var dark:text-on-sur-var-d mb-16 w-full text-center text-4xl leading-normal wrap-break-word hyphens-manual"
      >
        {{- . -}}
      </h2>
    {{- end }}
    <div class="font-300 max-w-story text-center text-xl leading-relaxed">
      {{ $content }}
    </div>
  </div>
{{- end -}}

<!-- prettier-ignore -->
{{- /*
  schema-wrapper.html (partial): Generates a unique hash key for caching the schema.org partial.

  The schema.org markup included in the Alpha theme can potentially impact build performance on large sites.
  To mitigate this, the schema is only rebuilt when a relevant value changes.

  The values used in the schema are combined and hashed using MD5 to generate an 
  efficient cache key.

  Dependencies: 
  - partial "head/seo/schema/base.html"

  Repo: https://github.com/oxypteros/alpha
*/ -}}
{{- /* Default Values */ -}}
{{- $pageNum := 1 }}
{{- $totalItems := 0 }}

{{- /* Additional values for sections */ -}}
{{- if .IsSection }}
  {{- $paginator := .Paginator }}
  {{- with $paginator }}
    {{- $pageNum = .PageNumber }}
    {{- $totalItems = .TotalNumberOfElements }}
  {{- end }}
{{- end }}

{{- $cacheKey := slice
  .Permalink
  (time .Lastmod).Unix
  (time .Date).Unix
  .Type
  .Kind
  .Layout
  (.Params.description | default "")
  (.Params.seo_description | default "")
  $pageNum
  $totalItems
-}}

{{- $finalCacheKey := delimit $cacheKey "::" | md5 -}}
{{- partialCached "head/seo/schema/base.html" . $finalCacheKey -}}
{{ $finalCacheKey }}
